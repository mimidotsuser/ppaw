<app-content-header title="Material Requisition Approval"
                    [menuItems]="['Home','Material Requisition Requests','Approval']">
</app-content-header>

<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center my-3 flex-wrap-reverse gap-2">

  </div>

  <div class="row">
    <div class="col-md-3 mb-3">
      <label for="request_id" class="form-label">Request No.</label>
      <input type="text" class="form-control" disabled id="request_id"
             [value]="formatOrderId(model?.order_id||0)">
    </div>

    <div class="col-md-3 mb-3">
      <label for="name" class="form-label">Requested By</label>
      <input type="text" class="form-control" disabled id="name"
             [value]="name">
    </div>
    <div class="col-md-4 mb-3">
      <label for="created_at" class="form-label">Created On</label>
      <input type="text" class="form-control" disabled id="created_at"
             [value]="model?.created_at|date">
    </div>

    <ng-container *ngIf="requesterRemarks">
      <div class="col-md-6 mb-3">
        <label for="a_remarks" class="form-label">Requestor Remarks</label>
        <textarea id="a_remarks" class="form-control" disabled>{{requesterRemarks}}</textarea>
      </div>
    </ng-container>
    <ng-container *ngIf="verifierRemarks">
      <div class="col-md-6 mb-3">
        <label for="b_remarks" class="form-label">Verifier Remarks</label>
        <textarea id="b_remarks" class="form-control" disabled>{{verifierRemarks}}</textarea>
      </div>
    </ng-container>
  </div>

  <table class="table table-striped table-responsive table-bordered table-block-sm">
    <thead>
    <tr>
      <th>Item</th>
      <th>Purpose</th>
      <th>Client</th>
      <th>Worksheet</th>
      <th>Qty Requested</th>
      <th>Qty Verified</th>
      <th>Qty Approved</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let item of model?.order_items">
      <td>
        <span class="td-inline-label">Item</span>
        <div class="d-flex flex-column">
          {{item.product?.item_code}}
          <small class="text-muted">
            {{item.product?.local_description || item?.product?.description}}
          </small>
        </div>
      </td>
      <td>
        <span class="td-inline-label">Purpose</span>
        {{item.purpose}}
      </td>
      <td>
        <span class="td-inline-label">Client</span>
        <div class="d-flex flex-column">
          {{item?.client?.name}}
          <small class="text-muted">
            {{item?.client?.branch || item?.client?.region}}
          </small>
        </div>
      </td>
      <td>
        <span class="td-inline-label">Worksheet</span>
        <a *ngIf="item.worksheet_id" routerLink="/main/worksheets/" target="_blank">
          <fa-icon [icon]="faExternalLinkAlt"></fa-icon>
          view
        </a>
      </td>
      <td>
        <span class="td-inline-label">Qty Requested</span>
        <div class="text-sm-center"> {{item.qty_requested}}</div>
      </td>
      <td>
        <span class="td-inline-label">Qty Verified</span>
        <div class="text-sm-center"> {{item.qty_approved}}</div>
      </td>
      <td class="qty-cell">
        <span class="td-inline-label">Qty Approval</span>
        <input type="number" class="form-control" min="0" max="{{item.qty_approved}}"
               [value]="item.qty_approved">
      </td>
    </tr>
    </tbody>
  </table>
  <div class="row">
    <div class="col-md-6 mb-3">
      <label for="remarks" class="form-label">Remarks</label>
      <textarea id="remarks" class="form-control"></textarea>
    </div>
    <div class="col-12">
      <button type="button" class="btn btn-primary" (click)="submit()"
              [disabled]="form.invalid">
        Submit
      </button>
    </div>
  </div>

</div>
